"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.nsResolver = nsResolver;
exports.createSVG = createSVG;
exports.clearSVG = clearSVG;
exports.svgCSS = svgCSS;
exports.svgText = svgText;
exports.svgSpan = svgSpan;
exports.svgGroup = svgGroup;
exports.svgLine = svgLine;
exports.svgRect = svgRect;
exports.svgRoundedRect = svgRoundedRect;

////////////////
// SVG util functions
function nsResolver(prefix) {
  var ns = {
    'xml': 'http://www.w3.org/1999/xml',
    'mei': 'http://www.music-encoding.org/ns/mei'
  };
  return ns[prefix] || null;
}

var MEINS = "http://www.music-encoding.org/ns/mei";
var SVGNS = "http://www.w3.org/2000/svg";

function createSVG(w, h) {
  var svg = document.createElementNS(SVGNS, "svg");
  if (w) svg.setAttributeNS(null, "width", w);
  if (h) svg.setAttributeNS(null, "height", h);
  return svg;
}

function clearSVG(svgEl) {
  while (svgEl.firstChild) {
    svgEl.removeChild(svgEl.firstChild);
  }
}

function svgCSS(element, css) {
  var link = document.createElementNS(SVGNS, "link");
  link.setAttributeNS(null, "href", css);
  link.setAttributeNS(null, "type", "text/css");
  link.setAttributeNS(null, "rel", "stylesheet");
  element.appendChild(link);
  return element;
}

function svgText(svgEl, x, y, cname, id, style, content) {
  var el = document.createElementNS(SVGNS, "text");
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.id = id;
  if (x) el.setAttributeNS(null, "x", x);
  if (y) el.setAttributeNS(null, "y", y);
  if (style) el.setAttributeNS(null, "style", style);
  if (content == 0 || content) el.appendChild(document.createTextNode(content));
  if (svgEl) svgEl.appendChild(el);
  return el;
}

function svgSpan(svgEl, cname, id, content) {
  var el = document.createElementNS(SVGNS, "tspan");
  if (content) var textNode = document.createTextNode(content);
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.id = id;
  if (content) el.appendChild(textNode);
  if (svgEl) svgEl.appendChild(el);
  return el;
}

function svgGroup(svgEl, cname, id) {
  var el = document.createElementNS(SVGNS, "g");
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.id = id;
  if (svgEl) svgEl.appendChild(el);
  return el;
}

function svgLine(svgEl, x1, y1, x2, y2, cname, id) {
  var el = document.createElementNS(SVGNS, "line");
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.setAttributeNS(null, "id", id);
  el.setAttributeNS(null, "x1", x1);
  el.setAttributeNS(null, "y1", y1);
  el.setAttributeNS(null, "x2", x2);
  el.setAttributeNS(null, "y2", y2);
  if (svgEl) svgEl.appendChild(el);
  return el;
}

function svgRect(svgEl, x, y, width, height, cname, id) {
  var el = document.createElementNS(SVGNS, "rect");
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.setAttributeNS(null, "id", id);
  if (x) el.setAttributeNS(null, "x", x);
  if (y) el.setAttributeNS(null, "y", y);
  if (width) el.setAttributeNS(null, "width", width);
  if (height) el.setAttributeNS(null, "height", height);
  if (svgEl) svgEl.appendChild(el);
  return el;
}

function svgRoundedRect(svgEl, x, y, width, height, rx, ry, cname, id) {
  var el = document.createElementNS(SVGNS, "rect");
  if (cname) el.setAttributeNS(null, "class", cname);
  if (id) el.setAttributeNS(null, "id", id);
  if (x) el.setAttributeNS(null, "x", x);
  if (y) el.setAttributeNS(null, "y", y);
  if (rx) el.setAttributeNS(null, "rx", rx);
  if (ry) el.setAttributeNS(null, "ry", ry);
  if (width) el.setAttributeNS(null, "width", width);
  if (height) el.setAttributeNS(null, "height", height);
  if (svgEl) svgEl.appendChild(el);
  return el;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWJyYXJ5L3N2Z1V0aWxzLmpzIl0sIm5hbWVzIjpbIm5zUmVzb2x2ZXIiLCJwcmVmaXgiLCJucyIsIk1FSU5TIiwiU1ZHTlMiLCJjcmVhdGVTVkciLCJ3IiwiaCIsInN2ZyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwic2V0QXR0cmlidXRlTlMiLCJjbGVhclNWRyIsInN2Z0VsIiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwic3ZnQ1NTIiwiZWxlbWVudCIsImNzcyIsImxpbmsiLCJhcHBlbmRDaGlsZCIsInN2Z1RleHQiLCJ4IiwieSIsImNuYW1lIiwiaWQiLCJzdHlsZSIsImNvbnRlbnQiLCJlbCIsImNyZWF0ZVRleHROb2RlIiwic3ZnU3BhbiIsInRleHROb2RlIiwic3ZnR3JvdXAiLCJzdmdMaW5lIiwieDEiLCJ5MSIsIngyIiwieTIiLCJzdmdSZWN0Iiwid2lkdGgiLCJoZWlnaHQiLCJzdmdSb3VuZGVkUmVjdCIsInJ4IiwicnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ08sU0FBU0EsVUFBVCxDQUFvQkMsTUFBcEIsRUFBNEI7QUFDakMsTUFBSUMsRUFBRSxHQUFHO0FBQ1AsV0FBUSw0QkFERDtBQUVQLFdBQU87QUFGQSxHQUFUO0FBSUEsU0FBT0EsRUFBRSxDQUFDRCxNQUFELENBQUYsSUFBYyxJQUFyQjtBQUNEOztBQUNELElBQUlFLEtBQUssR0FBRyxzQ0FBWjtBQUNBLElBQUlDLEtBQUssR0FBRyw0QkFBWjs7QUFFTyxTQUFTQyxTQUFULENBQW9CQyxDQUFwQixFQUFzQkMsQ0FBdEIsRUFBd0I7QUFDN0IsTUFBSUMsR0FBRyxHQUFDQyxRQUFRLENBQUNDLGVBQVQsQ0FBeUJOLEtBQXpCLEVBQStCLEtBQS9CLENBQVI7QUFDQSxNQUFHRSxDQUFILEVBQU1FLEdBQUcsQ0FBQ0csY0FBSixDQUFtQixJQUFuQixFQUF5QixPQUF6QixFQUFrQ0wsQ0FBbEM7QUFDTixNQUFHQyxD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RUFBd0RDLEVBQXhELEVBQTJEbkIsS0FBM0QsRUFBa0VDLEVBQWxFLEVBQXFFO0FBQzFFLE1BQUlHLEVBQUUsR0FBR25CLFFBQVEsQ0FBQ0MsZUFBVCxDQUF5Qk4sS0FBekIsRUFBZ0MsTUFBaEMsQ0FBVDtBQUNBLE1BQUdvQixLQUFILEVBQVVJLEVBQUUsQ0FBQ2pCLGNBQUgsQ0FBa0IsSUFBbEIsRUFBd0IsT0FBeEIsRUFBaUNhLEtBQWpDO0FBQ1YsTUFBR0MsRUFBSCxFQUFPRyxFQUFFLENBQUNqQixjQUFILENBQWtCLElBQWxCLEVBQXdCLElBQXhCLEVBQThCYyxFQUE5QjtBQUNQLE1BQUdILENBQUgsRUFBTU0sRUFBRSxDQUFDakIsY0FBSCxDQUFrQixJQUFsQixFQUF3QixHQUF4QixFQUE2QlcsQ0FBN0I7QUFDTixNQUFHQyxDQUFILEVBQU1LLEVBQUUsQ0FBQ2pCLGNBQUgsQ0FBa0IsSUFBbEIsRUFBd0IsR0FBeEIsRUFBNkJZLENBQTdCO0FBQ04sTUFBR21CLEVBQUgsRUFBT2QsRUFBRSxDQUFDakIsY0FBSCxDQUFrQixJQUFsQixFQUF3QixJQUF4QixFQUE4QitCLEVBQTlCO0FBQ1AsTUFBR0MsRUFBSCxFQUFPZixFQUFFLENBQUNqQixjQUFILENBQWtCLElBQWxCLEVBQXdCLElBQXhCLEVBQThCZ0MsRUFBOUI7QUFDUCxNQUFHSixLQUFILEVBQVVYLEVBQUUsQ0FBQ2pCLGNBQUgsQ0FBa0IsSUFBbEIsRUFBd0IsT0FBeEIsRUFBaUM0QixLQUFqQztBQUNWLE1BQUdDLE1BQUgsRUFBV1osRUFBRSxDQUFDakIsY0FBSCxDQUFrQixJQUFsQixFQUF3QixRQUF4QixFQUFrQzZCLE1BQWxDO0FBQ1gsTUFBRzNCLEtBQUgsRUFBVUEsS0FBSyxDQUFDTyxXQUFOLENBQWtCUSxFQUFsQjtBQUNWLFNBQU9BLEVBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8vLy8vLy8vLy8vLy8vLy9cbi8vIFNWRyB1dGlsIGZ1bmN0aW9uc1xuZXhwb3J0IGZ1bmN0aW9uIG5zUmVzb2x2ZXIocHJlZml4KSB7XG4gIHZhciBucyA9IHtcbiAgICAneG1sJyA6ICdodHRwOi8vd3d3LnczLm9yZy8xOTk5L3htbCcsXG4gICAgJ21laSc6ICdodHRwOi8vd3d3Lm11c2ljLWVuY29kaW5nLm9yZy9ucy9tZWknXG4gIH07XG4gIHJldHVybiBuc1twcmVmaXhdIHx8IG51bGw7XG59XG52YXIgTUVJTlMgPSBcImh0dHA6Ly93d3cubXVzaWMtZW5jb2Rpbmcub3JnL25zL21laVwiO1xudmFyIFNWR05TID0gXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU1ZHICh3LGgpe1xuICB2YXIgc3ZnPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhTVkdOUyxcInN2Z1wiKTtcbiAgaWYodykgc3ZnLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwid2lkdGhcIiwgdyk7XG4gIGlmKGgpIHN2Zy5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImhlaWdodFwiLCBoKTtcbiAgcmV0dXJuIHN2Zztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyU1ZHKHN2Z0VsKXtcbiAgd2hpbGUoc3ZnRWwuZmlyc3RDaGlsZCl7XG4gICAgc3ZnRWwucmVtb3ZlQ2hpbGQoc3ZnRWwuZmlyc3RDaGlsZCk7XG4gIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBzdmdDU1MoZWxlbWVudCwgY3NzKXtcbiAgdmFyIGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoU1ZHTlMsIFwibGlua1wiKTtcbiAgbGluay5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImhyZWZcIiwgY3NzKTtcbiAgbGluay5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInR5cGVcIiwgXCJ0ZXh0L2Nzc1wiKTtcbiAgbGluay5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInJlbFwiLCBcInN0eWxlc2hlZXRcIik7XG4gIGVsZW1lbnQuYXBwZW5kQ2hpbGQobGluayk7XG4gIHJldHVybiBlbGVtZW50O1xufVxuZXhwb3J0IGZ1bmN0aW9uIHN2Z1RleHQoc3ZnRWwsIHgsIHksIGNuYW1lLCBpZCwgc3R5bGUsIGNvbnRlbnQpe1xuICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoU1ZHTlMsIFwidGV4dFwiKTtcbiAgaWYoY25hbWUpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwiY2xhc3NcIiwgY25hbWUpO1xuICBpZihpZCkgZWwuaWQgPSBpZDtcbiAgaWYoeCkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJ4XCIsIHgpO1xuICBpZih5KSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInlcIiwgeSk7XG4gIGlmKHN0eWxlKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInN0eWxlXCIsIHN0eWxlKTtcbiAgaWYoY29udGVudCA9PSAwIHx8IGNvbnRlbnQpIGVsLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNvbnRlbnQpKTtcbiAgaWYoc3ZnRWwpIHN2Z0VsLmFwcGVuZENoaWxkKGVsKTtcbiAgcmV0dXJuIGVsO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHN2Z1NwYW4oc3ZnRWwsIGNuYW1lLCBpZCwgY29udGVudCl7XG4gIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhTVkdOUywgXCJ0c3BhblwiKTtcbiAgaWYoY29udGVudCkgdmFyIHRleHROb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY29udGVudCk7XG4gIGlmKGNuYW1lKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImNsYXNzXCIsIGNuYW1lKTtcbiAgaWYoaWQpIGVsLmlkID0gaWQ7XG4gIGlmKGNvbnRlbnQpIGVsLmFwcGVuZENoaWxkKHRleHROb2RlKTtcbiAgaWYoc3ZnRWwpICBzdmdFbC5hcHBlbmRDaGlsZChlbCk7XG4gIHJldHVybiBlbDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzdmdHcm91cChzdmdFbCwgY25hbWUsIGlkKXtcbiAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFNWR05TLCBcImdcIik7XG4gIGlmKGNuYW1lKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImNsYXNzXCIsIGNuYW1lKTtcbiAgaWYoaWQpIGVsLmlkID0gaWQ7XG4gIGlmKHN2Z0VsKSBzdmdFbC5hcHBlbmRDaGlsZChlbCk7XG4gIHJldHVybiBlbDtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzdmdMaW5lKHN2Z0VsLCB4MSwgeTEsIHgyLCB5MiwgY25hbWUsIGlkKXtcbiAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFNWR05TLCBcImxpbmVcIik7XG4gIGlmKGNuYW1lKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImNsYXNzXCIsIGNuYW1lKTtcbiAgaWYoaWQpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwiaWRcIiwgaWQpO1xuICBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcIngxXCIsIHgxKTtcbiAgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJ5MVwiLCB5MSk7XG4gIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwieDJcIiwgeDIpO1xuICBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInkyXCIsIHkyKTtcbiAgaWYoc3ZnRWwpIHN2Z0VsLmFwcGVuZENoaWxkKGVsKTtcbiAgcmV0dXJuIGVsO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHN2Z1JlY3Qoc3ZnRWwsIHgsIHksIHdpZHRoLCBoZWlnaHQsIGNuYW1lLCBpZCl7XG4gIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhTVkdOUywgXCJyZWN0XCIpO1xuICBpZihjbmFtZSkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJjbGFzc1wiLCBjbmFtZSk7XG4gIGlmKGlkKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImlkXCIsIGlkKTtcbiAgaWYoeCkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJ4XCIsIHgpO1xuICBpZih5KSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInlcIiwgeSk7XG4gIGlmKHdpZHRoKSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcIndpZHRoXCIsIHdpZHRoKTtcbiAgaWYoaGVpZ2h0KSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcImhlaWdodFwiLCBoZWlnaHQpO1xuICBpZihzdmdFbCkgc3ZnRWwuYXBwZW5kQ2hpbGQoZWwpO1xuICByZXR1cm4gZWw7XG59XG5leHBvcnQgZnVuY3Rpb24gc3ZnUm91bmRlZFJlY3Qoc3ZnRWwsIHgsIHksIHdpZHRoLCBoZWlnaHQsIHJ4LCByeSxjbmFtZSwgaWQpe1xuICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoU1ZHTlMsIFwicmVjdFwiKTtcbiAgaWYoY25hbWUpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwiY2xhc3NcIiwgY25hbWUpO1xuICBpZihpZCkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJpZFwiLCBpZCk7XG4gIGlmKHgpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwieFwiLCB4KTtcbiAgaWYoeSkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJ5XCIsIHkpO1xuICBpZihyeCkgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgXCJyeFwiLCByeCk7XG4gIGlmKHJ5KSBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBcInJ5XCIsIHJ5KTtcbiAgaWYod2lkdGgpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwid2lkdGhcIiwgd2lkdGgpO1xuICBpZihoZWlnaHQpIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIFwiaGVpZ2h0XCIsIGhlaWdodCk7XG4gIGlmKHN2Z0VsKSBzdmdFbC5hcHBlbmRDaGlsZChlbCk7XG4gIHJldHVybiBlbDtcbn1cbiJdfQ==